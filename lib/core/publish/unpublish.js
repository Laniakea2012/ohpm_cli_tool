"use strict";var e=this&&this.__awaiter||function(e,i,t,r){return new(t||(t=Promise))((function(n,o){function s(e){try{l(r.next(e))}catch(e){o(e)}}function u(e){try{l(r.throw(e))}catch(e){o(e)}}function l(e){var i;e.done?n(e.value):(i=e.value,i instanceof t?i:new t((function(e){e(i)}))).then(s,u)}l((r=r.apply(e,i||[])).next())}))};Object.defineProperty(exports,"__esModule",{value:!0}),exports.unpublish=void 0;const i=require("../../util"),t=require("../registry/registry"),r=require("../../common/message"),n=require("../registry/publication/impl/OhpmPublication"),o=require("../registry/publication/utils/getAuthorization");exports.unpublish=function(s,u){return e(this,void 0,void 0,(function*(){let e="";const l="@"===s[0]?s.slice(1).indexOf("@")+1:s.indexOf("@");let c=l>0?s.slice(0,l):s;if(l>0&&(e=s.slice(l+1)),!e&&!u.force)throw new Error(r.Messages.UnPublish.DeleteAllVersionPkgNotForce);let a=(0,t.getPublishRegistry)();if(void 0!==u.publish_registry&&(a=u.publish_registry),null==a||!a.length)throw new Error(r.Messages.Validator.PublishRegistryError);a.endsWith("/")||(a=a.concat("/")),c=c.replace("/","%2f");const h=yield(0,o.getAuthorization)(a);yield new n.OhpmPublication(h).unpublishPackage(c,e,a),(0,i.output)("Unpublish end")}))};